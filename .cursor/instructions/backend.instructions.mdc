# Backend Development Guidelines

This document provides backend-specific context and coding guidelines for the Convex backend located in `services/backend`.

## Authentication Conventions

### Backend Authentication

All Convex backend queries, mutations, and actions that require authentication must use `SessionIdArg` from convex-helpers:

```ts
import { SessionIdArg } from "convex-helpers/server/sessions";

export const myQuery = query({
  args: {
    ...SessionIdArg,
    // other args
  },
  handler: async (ctx, args) => {
    // Implementation
  },
});
```

**Core Directive:** Require SessionIdArg for any authenticated backend functions.
**Why:** Ensures consistent auth handling and prevents unauthenticated access.
**Scope:** Convex queries, mutations, and actions.

### Auth Provider

The application uses the `AuthProvider` component to provide authentication state to the entire app.

**Context:** Frontend provides session via AuthProvider; backend expects SessionIdArg.

## Feature Flags

Feature flags for the app are configured in [featureFlags.ts](../../services/backend/config/featureFlags.ts).

### Verification Checklist:
- Are new flags added with safe defaults (off/false)?
- Are flag reads centralized and typed?
- Is there a migration or fallback path when removing a flag?